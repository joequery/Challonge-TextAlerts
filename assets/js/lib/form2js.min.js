(function(x,q){"function"===typeof define&&define.amd?define(q):x.form2js=q()})(this,function(){function x(a,k,g,h){var e=u(a,k,g,h);return 0<e.length?e:q(a,k,g,h)}function q(a,k,g,h){var e=[];for(a=a.firstChild;a;)e=e.concat(u(a,k,g,h)),a=a.nextSibling;return e}function u(a,k,g,h){if(a.disabled&&!h)return[];var e,f;f=a.name&&""!=a.name?a.name:g&&a.id&&""!=a.id?a.id:"";(e=k&&k(a))&&e.name?f=[e]:""!=f&&a.nodeName.match(/INPUT|TEXTAREA/i)?(a=A(a,h),f=null===a?[]:[{name:f,value:a}]):""!=f&&a.nodeName.match(/SELECT/i)?
(a=A(a,h),f=[{name:f.replace(/\[\]$/,""),value:a}]):f=q(a,k,g,h);return f}function A(a,k){if(a.disabled&&!k)return null;switch(a.nodeName){case "INPUT":case "TEXTAREA":switch(a.type.toLowerCase()){case "radio":if(a.checked&&"false"===a.value)return!1;case "checkbox":if(a.checked&&"true"===a.value)return!0;if(!a.checked&&"true"===a.value)return!1;if(a.checked)return a.value;break;case "button":case "reset":case "submit":case "image":return"";default:return a.value}break;case "SELECT":var g;g=[];var h,
e,f;if(a.multiple)for(h=a.getElementsByTagName("option"),e=0,f=h.length;e<f;e++)h[e].selected&&g.push(h[e].value);else g=a.value;return g}return null}return function(a,k,g,h,e,f){f=f?!0:!1;if("undefined"==typeof g||null==g)g=!0;if("undefined"==typeof k||null==k)k=".";5>arguments.length&&(e=!1);a="string"==typeof a?document.getElementById(a):a;var t=[],q,y=0;if(a.constructor==Array||"undefined"!=typeof NodeList&&a.constructor==NodeList)for(;q=a[y++];)t=t.concat(x(q,h,e,f));else t=x(a,h,e,f);q=g;var y=
k,u={},r={},v,l,b,w,s,n,d,m,p,c,z;for(v=0;v<t.length;v++)if(s=t[v].value,!q||""!==s&&null!==s){l=t[v].name;z=l.split(y);n=[];d=u;m="";for(l=0;l<z.length;l++)if(c=z[l].split("]["),1<c.length)for(b=0;b<c.length;b++)if(c[b]=0==b?c[b]+"]":b==c.length-1?"["+c[b]:"["+c[b]+"]",p=c[b].match(/([a-z_]+)?\[([a-z_][a-z0-9_]+?)\]/i))for(w=1;w<p.length;w++)p[w]&&n.push(p[w]);else n.push(c[b]);else n=n.concat(c);for(l=0;l<n.length;l++)c=n[l],-1<c.indexOf("[]")&&l==n.length-1?(b=c.substr(0,c.indexOf("[")),m+=b,d[b]||
(d[b]=[]),d[b].push(s)):-1<c.indexOf("[")?(b=c.substr(0,c.indexOf("[")),p=c.replace(/(^([a-z_]+)?\[)|(\]$)/gi,""),m+="_"+b+"_"+p,r[m]||(r[m]={}),""==b||d[b]||(d[b]=[]),l==n.length-1?""==b?(d.push(s),r[m][p]=d[d.length-1]):(d[b].push(s),r[m][p]=d[b][d[b].length-1]):r[m][p]||(/^[0-9a-z_]+\[?/i.test(n[l+1])?d[b].push({}):d[b].push([]),r[m][p]=d[b][d[b].length-1]),d=r[m][p]):(m+=c,l<n.length-1?(d[c]||(d[c]={}),d=d[c]):d[c]=s)}return u}});
